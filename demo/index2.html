<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html" charset="utf-8"/>
  <title>FingerPose Example</title>
  <!-- The fingerpose library -->
  <script src="/dist/fingerpose.js" type="text/javascript"></script>
  <link rel="stylesheet" href="./index.css">
</head>
<body>
  <div class="container">
    <div class="video">
      <div id="video-container">
        <video id="pose-video" class="layer" playsinline></video>
        <div id="pose-result" class="layer"></div>
      </div>
    </div>
  </div>

  <script>
    const config = {
      video: { width: 640, height: 480, fps: 30 }
    };
    const gestureStrings = {
      'thumbs_up': 'ðŸ‘',
      'thumbs_down': 'ðŸ‘Ž',
      'victory': 'âœŒðŸ»',
      'raised_back_hand':'ðŸ¤š',
      'raised_fist_hand': 'âœŠ'
    };

    async function initCamera(width, height, fps) {
      const constraints = {
        audio: false,
        video: {
          facingMode: "user",
          width: width,
          height: height,
          frameRate: { max: fps }
        }
      };
      const video = document.querySelector("#pose-video");
      video.width = width;
      video.height = height;
      // get video stream
      const stream = await navigator.mediaDevices.getUserMedia(constraints);
      video.srcObject = stream;
      return video
    }

    async function main() {
      console.log('fp', fp)

      const resultLayer = document.querySelector("#pose-result");
      // configure gesture estimator
      const knownGestures = [
        fp.Gestures.VictoryGesture,
        fp.Gestures.ThumbsUpGesture,
        fp.Gestures.ThumbsDownGesture,
        fp.Gestures.RaisedBackHandGesture,
        fp.Gestures.RaisedFistHandGesture,
      ];
      const GE = new fp.RealTimeGestureEstimator(knownGestures);
      GE.on('gesture', (gesture) => {
        console.log('gesture', gesture)
      });
      await GE.initialize();
    }

    window.addEventListener("DOMContentLoaded", async () => {
      const video = await initCamera( config.video.width, config.video.height, config.video.fps )
      video.play();
      main();
    });
  </script>

</body>
</html>
